<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Drive Doc Search</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- important for mobile scaling -->


  <style>
    body { font-family: Arial, sans-serif; margin: 0; display: flex; flex-direction: row; height: 100vh; }

    .left { width: 40%; padding: 20px; border-right: 1px solid #ddd; overflow-y: auto; }
    .right { flex: 1; padding: 20px; display: flex; flex-direction: column; }
    #results { margin-top: 20px; }
    .file-item { margin: 10px 0; cursor: pointer; color: blue; text-decoration: underline; word-break: break-word; }
    iframe { width: 100%; flex-grow: 1; border: none; }

    /* ðŸ”¥ Mobile responsive */
    @media (max-width: 768px) {
      body { flex-direction: column; }
      .left { width: 100%; border-right: none; border-bottom: 1px solid #ddd; height: 40%; }
      .right { width: 100%; height: 60%; }
      iframe { height: 100%; }
    }


  </style>


</head>
<body>
  <div class="left">
    <h2>Search Docs</h2>
    <input type="text" id="query" placeholder="Enter keyword">
    <button onclick="searchDocs()">Search</button>
    <div id="results"></div>
  </div>
  <div class="right">
    <h2>Preview</h2>
    <iframe id="preview" src=""></iframe>
  </div>

<script>
const API_KEY = "AIzaSyAkCUKSryImjwlHo8PRZsc9msVnrE110AQ"; 
const FOLDER_ID = "1OocPoUyJcBApfb9_aiYau_G_jBfZXIEp";

// Show all files when page loads
window.onload = () => {
  listAllFiles();
};

async function listAllFiles() {
  const url = `https://www.googleapis.com/drive/v3/files?q='${FOLDER_ID}'+in+parents&key=${API_KEY}&fields=files(id,name,mimeType,webViewLink)`;
  const res = await fetch(url);
  const data = await res.json();
  displayResults(data.files);
}

async function searchDocs() {
  const query = document.getElementById("query").value;
  const url = `https://www.googleapis.com/drive/v3/files?q='${FOLDER_ID}'+in+parents+and+name+contains+'${query}'&key=${API_KEY}&fields=files(id,name,mimeType,webViewLink)`;
  const res = await fetch(url);
  const data = await res.json();
  displayResults(data.files);
}

function displayResults(files) {
  const resultsDiv = document.getElementById("results");
  resultsDiv.innerHTML = "";

  if (!files || files.length === 0) {
    resultsDiv.innerHTML = "<p>No results found.</p>";
    return;
  }

  files.forEach(file => {
    const div = document.createElement("div");
    div.className = "file-item";
    div.innerText = file.name;
    div.onclick = () => {
      if (file.mimeType.includes("document")) {
        document.getElementById("preview").src = `https://docs.google.com/document/d/${file.id}/preview`;
      } else if (file.mimeType.includes("presentation")) {
        document.getElementById("preview").src = `https://docs.google.com/presentation/d/${file.id}/preview`;
      } else if (file.mimeType.includes("spreadsheet")) {
        document.getElementById("preview").src = `https://docs.google.com/spreadsheets/d/${file.id}/preview`;
      } else if (file.mimeType.includes("pdf")) {
        document.getElementById("preview").src = `https://drive.google.com/file/d/${file.id}/preview`;
      } else {
        document.getElementById("preview").src = "";
        alert("Preview not supported for this file type.");
      }
    };

    const link = document.createElement("a");
    link.href = file.webViewLink;
    link.target = "_blank";
    link.innerText = " (Open)";

    div.appendChild(link);
    resultsDiv.appendChild(div);
  });
}
</script>
</body>
</html>
